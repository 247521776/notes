- [btc搭建私链指南](./btc/note.md)
- [eth搭建私链指南](./eth/note.md)
- [区块链常见问题](./question.md)

## eth

- [web3使用中问题解决记录](./eth/web3_question.md)
- [ethereumjs-tx使用中问题解决记录](./eth/ethereumjs_tx_question.md)

# 区块链中的概念

## 私钥、公钥、地址

- 私钥
  一串随机字符串，相当于密码
- 公钥
  通过私钥进行椭圆曲线加密法得来的，作用是验证签名
- 地址
  通过公钥进行摘要算法得来的，作用是可以不暴露公钥的真实内容
  
#### 总结

对于私钥，公钥和地址来说，公钥作为私钥到地址的中间桥梁，他在交易的验证是最关键的：

对于一个交易的验证，公钥的作用：

公钥生成地址，验证发送交易的地址是否和该公钥生成的地址一致
公钥验证私钥的签名，用来验证该交易是否使用了正确的私钥签名
私钥生成公钥是成对出现，公钥可以生成对应的唯一地址，这样就能确认了该地址发送的交易是否使用了对应的私钥

[参考地址](https://www.jianshu.com/p/af6328cc693e)

## 私链、测试链、共链

- 私链
  用于开发人员调研使用的，非公开性的，回归测试链
- 测试链
  拥有主链一样的功能，用于不破坏主链的情况下尝试新的想法
- 共链
  公开的、可用的区块链
  
## UXTO ACCOUNT

|模型|诠释|
|---|---|
|UXTO|未花费交易输出|
|ACCOUNT|账户模型|

## 共识算法

共识算法可以被定义为使区块链网络达成共识的机制。公共（去中心化）区块链是作为分布式系统来构建的，由于它们不依赖于一个中央权威，因此分散的节点需要就交易的有效与否达成一致。这就是共识算法发挥作用的地方，确保所有节点都遵守协议规则并保证所有交易都以可靠的方式进行，即每个货币都只能花一次。

### 共识算法与协议

算法和协议作为术语经常会被互换使用，但是它们并不是同一回事。通常来说，**协议**是定义区块链的**主要规则**，而**算法**是定义遵循这些规则的**机制**。  
  
区块链是建立在一个协议之上的，该协议将定义系统如何工作，因此系统的所有不同部分和网络的所有参与者都需要遵循这些规则。  

虽然协议确定了规则是什么，但是算法告诉系统采取哪些步骤来遵循这些规则，并最终产生所需的结果。例如，区块链的共识算法决定了交易和区块的有效性。因此，**比特币**和**以太坊**是**协议**，而**工作量证明**和**权益证明**是它们的**共识算法**。  

进一步来说，比特币协议定义了节点间应如何交互，数据应如何在它们之间传输，以及区块验证成功的要求是什么。另一方面，公式算法负责验证余额和签名，确认交易，以及实际执行区块验证，所有这些都取决于网络共识。  

### 工作量证明（Pow -> proof of work）

工作量证明是第一个被建立的共识算法。  

工作量证明挖矿涉及到大量哈希（算力）的（挖矿）的尝试，因此更多的算力意味着每秒更多的尝试。换句话说，算力高的矿工有更多机会找到下一个区块的解。如果网络的分布式节点达成共识并且确认矿工提供的块哈希是有效的工作证明，则工作量证明共识算法确保该矿工仅能够验新区块里的交易并将其添加到区块链。

### 权益证明（PoS -> proof of sale）

由于工作量证明需要大量的算力，导致会浪费很多资源，所以作为工作量证明的替代方案，权益证明共识算法在2011年被踢出。尽管工作量证明和权益证明有着相同的目标，但它们存在根本的差异性特殊性。  

简单来说，权益证明共识算法用一种机制来取代工作量证明的挖矿，期中区块根据参与者的质押的币而验证。每个区块的验证者（也称为铸造者或者铸币者）由本身的加密货币投资决定，而不是分配的算力数量。每个权益证明系统可以以不同的方式来实现该算法，但是通常来说，区块链由随机的选举过程保护，该过程考虑了节点的财富、币龄（币被锁定或者是质押的时间）以及随机因素。

### 委托权益证明（DPoS -> delegated proof of stake）

DPOS最早出现在比特股中，又称受托人机制，它的原理是让每一个持有比特股的人进行投票，由此产生101位代表 。我们可以将其理解为101个超级节点或者矿池，而这101个超级节点彼此的权利完全相等。

从某种角度来看，DPOS有点像是议会制度或人民代表大会制度。如果代表不能履行他们的职责（当轮到他们时，没能生成区块），他们会被除名，网络会选出新的超级节点来取代他们。DPOS的出现最主要还是因为矿机的产生，大量的算力在不了解也不关心数字货币的人身上，类似演唱会的黄牛，大量囤票而丝毫不关心演唱会的内容。

DPOS通过其选择区块生产者和验证节点质量的算法确保了安全性，同时消除了交易需要等待一定数量区块被非信任节点验证的时间消耗。通过减少确认的要求，DPOS算法大大提高了交易的速度。通过信任少量的诚信节点，可以去除区块签名过程中不必要的步骤。

### 冷钱包、热钱包  

#### 冷钱包

冷钱包指的是互联网不能访问到你私钥的钱包。  

#### 热钱包  

热钱包指的是互联网能访问到你私钥的钱包。

### 软分叉、硬分叉

#### 软分叉

当新共识规则发布后，没有升级的节点会因为不知道新共识规则下，而生产不合法的区块，就会产生临时性分叉，又称软分叉。

**解决方案**：未升级的节点在适当的时间完成升级，和已升级的节点汇合且数据互通，就能消除分叉，这种操作适合软分叉。

#### 硬分叉

区块链发生永久性分歧，在新共识规则发布后，部分没有升级的节点无法验证已经升级的节点生产的区块，通常硬分叉就会发生。

**解决方案**：未升级的节点和已升级的节点同时再升级到更高级的版本（该高级版本可以让之前互不兼容的正常的数据互通），以此来消灭分叉，这种操作适合硬分叉。

案例：2015年7月4日，比特币区块链在区块高度363731发生一次硬分叉。当时是Bitcoin Core 开发者往新版本的0.10.0添加了BIP 66（相当于0.10.1版本）。这本来是一起软分叉的修改，在比特币网络上主要矿池都使用了0.10版本的软件时，但有一个大矿池BTC Nuggets没有升级，导致这个矿场挖出来的两个区块，被其他矿工拒绝，然后双方就各自挖矿延续自己认为是正确的区块链，由此产生硬分叉，分成了两条链。随后bitcoin.org发布公告，呼吁矿工升级到0.10.2版本来消灭分叉。


#### 回滚操作

**解决方案**：已升级的节点降级退回到未升级的状态（又称回滚操作），这样所有数据都会回到最初的状态，因此分叉也就消除了。这种操作也多用在硬分叉。

案例：2013年3月12日，bitcoin qt 0.8.0版本发布了，它采用了新的数据库。有的矿工节点升级了0.8版本，有的矿工还继续使用0.7版本的软件。双方各自生产区块，但0.8采用的新数据库生产出的区块被被0.7版本节点拒绝掉。这就发生了硬分叉。当时是采用0.8版本的矿工放弃了他们挖的链，退回到0.7版本上继续挖矿。
